#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ SSH –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ–¥ –≤–∞—à–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –¥–µ–ø–ª–æ—è"
echo "======================================"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
echo "üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $(whoami)"
echo "üè† –î–æ–º–∞—à–Ω—è—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $HOME"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
echo ""
echo "üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:"
if [ -d "$HOME/.ssh" ]; then
    echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ~/.ssh —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    ls -la $HOME/.ssh/
    echo ""
    echo "üîí –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:"
    stat -c "%a %n" $HOME/.ssh/
    if [ -f "$HOME/.ssh/authorized_keys" ]; then
        stat -c "%a %n" $HOME/.ssh/authorized_keys
        echo ""
        echo "üîë –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π –≤ authorized_keys:"
        wc -l $HOME/.ssh/authorized_keys
        echo ""
        echo "üìã –ü–µ—Ä–≤—ã–µ 50 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª—é—á–∞:"
        cut -c1-50 $HOME/.ssh/authorized_keys
    else
        echo "‚ùå –§–∞–π–ª authorized_keys –Ω–µ –Ω–∞–π–¥–µ–Ω"
    fi
else
    echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ~/.ssh –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
echo ""
echo "üìÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:"
if [ -d "/var/www/proexpert_land" ]; then
    echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /var/www/proexpert_land —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    ls -la /var/www/proexpert_land/
    echo ""
    echo "üë• –í–ª–∞–¥–µ–ª–µ—Ü –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:"
    stat -c "%U:%G %n" /var/www/proexpert_land/
else
    echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /var/www/proexpert_land –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –ø—Ä–∞–≤
echo ""
echo "üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –ø—Ä–∞–≤:"
echo "–ö–æ–º–∞–Ω–¥—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø–∞—Ä–æ–ª—è:"
sudo -l | grep -E "(nginx|systemctl|chown)" || echo "‚ùå –ù–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö sudo –ø—Ä–∞–≤"

echo ""
echo "‚ú® –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "üìù –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:"
echo "1. –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è ~/.ssh –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –µ—ë"
echo "2. –ï—Å–ª–∏ –Ω–µ—Ç authorized_keys - —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á"
echo "3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞: –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è 700, —Ñ–∞–π–ª 600"
echo "4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ" 