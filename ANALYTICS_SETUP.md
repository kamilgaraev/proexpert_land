# Настройка аналитики ProExpert

## Яндекс.Метрика

### 1. Создание счетчика
1. Перейдите на https://metrika.yandex.ru/
2. Создайте новый счетчик для домена `prohelper.pro`
3. Скопируйте ID счетчика

### 2. Настройка переменных окружения
Создайте файл `.env` в корне проекта:

```bash
# Яндекс.Метрика
REACT_APP_YANDEX_METRIKA_ID=123456789

# Другие настройки
REACT_APP_ENVIRONMENT=production
```

### 3. Настройка целей в Яндекс.Метрике
Рекомендуемые цели для отслеживания:

#### Основные цели:
- `registration` - Регистрация пользователя
- `login` - Вход в систему
- `form_submit` - Отправка любой формы
- `contact_form` - Обращение в поддержку

#### Маркетинговые цели:
- `pricing_view` - Просмотр тарифов
- `integration_interest` - Интерес к интеграциям
- `download` - Скачивание файлов
- `api_docs_view` - Просмотр API документации

#### События кнопок:
- `start_free` - Клик "Начать бесплатно"
- `watch_demo` - Клик "Смотреть демо"
- `select_plan_*` - Выбор тарифного плана

### 4. Настройка на сервере
Добавьте переменные в nginx или в систему:

```bash
# В /etc/environment или в .bashrc
export REACT_APP_YANDEX_METRIKA_ID=123456789
```

### 5. Проверка работы
После деплоя проверьте:
1. Счетчик появился в Яндекс.Метрике
2. События отслеживаются в режиме реального времени
3. Цели срабатывают корректно

## Дополнительные возможности

### Отслеживание конверсий
```typescript
import useAnalytics from '@hooks/useAnalytics';

const { trackGoal, trackEvent } = useAnalytics();

// Отслеживание цели
trackGoal('registration', { method: 'email' });

// Отслеживание события
trackEvent('button_click', { button_name: 'cta_hero' });
```

### Настройка вебвизора
Вебвизор включен по умолчанию. Для отключения:

```typescript
<YandexMetrika 
  counterId={metrikaId}
  enableWebvisor={false}
/>
```

### Настройка карты кликов
```typescript
<YandexMetrika 
  counterId={metrikaId}
  enableClickmap={true}
  enableTrackLinks={true}
/>
```

## Рекомендации по использованию

1. **Не перегружайте событиями** - отслеживайте только важные действия
2. **Используйте осмысленные имена** - `select_plan_professional` лучше чем `click1`
3. **Группируйте похожие события** - все клики по кнопкам в одну категорию
4. **Отслеживайте воронку** - от просмотра до регистрации и оплаты
5. **Регулярно анализируйте данные** - корректируйте UX на основе аналитики

## Проблемы и решения

### Метрика не загружается
- Проверьте ID счетчика
- Убедитесь что домен добавлен в настройки счетчика
- Проверьте блокировщики рекламы

### События не отслеживаются
- Проверьте консоль браузера на ошибки
- Убедитесь что функция `window.ym` доступна
- Проверьте правильность имен целей

### Дублирование событий
- Убедитесь что компонент не рендерится несколько раз
- Используйте `useCallback` для обработчиков событий 